# 地图缩放级别配置指南 🗺️

## 📖 概述

离线地图系统现在支持**缩放级别限制**，可以根据可用的瓦片数据自动调整地图的缩放范围，避免用户缩放到没有瓦片数据的级别。

## ⚙️ 配置文件

配置文件位置：`apps/web-frontend/src/config/map-config.js`

### 🎯 主要配置项

```javascript
export const MapConfig = {
  zoom: {
    offline: {
      min: 0,      // 离线瓦片最小缩放级别
      max: 6,      // 离线瓦片最大缩放级别  
      default: 3   // 默认缩放级别
    },
    online: {
      min: 0,      // 在线瓦片最小级别
      max: 18,     // 在线瓦片最大级别
      default: 10  // 在线默认级别
    },
    strictMode: true  // 是否严格限制缩放
  }
}
```

## 🔧 自定义配置

### 1. 修改缩放范围

根据您下载的瓦片数据修改配置：

```javascript
// 如果您下载了0-8级瓦片
offline: {
  min: 0,
  max: 8,      // 修改为实际最大级别
  default: 4   // 调整默认级别
}
```

### 2. 环境差异化配置

- **生产环境**: 严格按照`offline`配置限制
- **开发环境**: 允许更宽松的范围，可以使用在线瓦片

## 📊 当前瓦片数据状态

根据验证脚本检测：
- **可用级别**: 0-6级
- **瓦片总数**: 4,076个
- **覆盖范围**: 全球低分辨率

## 🎮 用户体验

### 缩放行为
- ✅ **可缩放范围**: 0-6级（生产环境）
- ✅ **自动检测**: 启动时检测可用瓦片级别
- ✅ **降级处理**: 检测失败时使用默认配置

### 视觉反馈
```javascript
ux: {
  showZoomInfo: false,              // 是否显示当前缩放级别
  showZoomLimitWarning: true,       // 是否显示限制提示
  zoomLimitMessages: {
    minReached: '已达到最小缩放级别',
    maxReached: '已达到最大缩放级别，离线瓦片数据不支持更高精度'
  }
}
```

## 🛠️ 调试信息

在浏览器控制台可以看到：
```
地图缩放限制: 0 - 6
检测到可用瓦片级别: 0 - 6
使用静态瓦片文件
```

## 📈 性能优化建议

### 1. 合理设置级别范围
- **最小级别**: 不要设置过小（0-1级足够）
- **最大级别**: 根据实际瓦片数据设置
- **默认级别**: 选择中等级别（3-5级）

### 2. 瓦片数据优化
```bash
# 下载更多级别的瓦片
cd tile-server
python3 download-tiles.py
# 选择更大范围或更高级别
```

### 3. 环境配置
- **生产环境**: 严格限制，确保用户体验
- **开发环境**: 宽松限制，便于调试

## 🚀 快速配置

### 扩展到10级缩放
1. 下载更多瓦片数据：
   ```bash
   cd tile-server
   python3 download-tiles.py
   # 选择更高级别的区域配置
   ```

2. 修改配置：
   ```javascript
   offline: {
     min: 0,
     max: 10,    // 扩展到10级
     default: 5  // 调整默认级别
   }
   ```

3. 重新构建：
   ```bash
   cd apps/web-frontend
   make build-with-tiles
   ```

### 自定义区域限制
```javascript
// 为特定区域优化缩放级别
offline: {
  min: 2,      // 跳过全球视图
  max: 8,      // 适合城市级别详细度
  default: 5   // 区域视图
}
```

---

**💡 提示**: 缩放级别限制可以显著改善离线地图的用户体验，避免加载失败和空白瓦片！ 