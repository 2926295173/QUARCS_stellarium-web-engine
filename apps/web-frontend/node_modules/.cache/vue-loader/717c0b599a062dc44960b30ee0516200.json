{"remainingRequest":"/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/src/components/date-time-picker.vue?vue&type=script&lang=js&","dependencies":[{"path":"/app/src/components/date-time-picker.vue","mtime":1747984180000},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1707125360000},{"path":"/app/node_modules/thread-loader/dist/cjs.js","mtime":1707125360000},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":1707125360000},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1707125360000},{"path":"/app/node_modules/vue-loader/lib/index.js","mtime":1707125450000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQgTW9tZW50IGZyb20gJ21vbWVudCcKdmFyIGNsaWNrVGltZW91dAp2YXIgbmJDbGlja1JlcGVhdCA9IDAKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gewogICAgICBzdG9wczogW10sCiAgICAgIHN0b3BDYWNoZUtleTogewogICAgICAgIHNsaWRlclN0YXJ0VGltZTogdW5kZWZpbmVkLAogICAgICAgIGxvY2F0aW9uOiB1bmRlZmluZWQKICAgICAgfQogICAgfQogIH0sCiAgcHJvcHM6IFsndmFsdWUnLCAnbG9jYXRpb24nXSwKICBjb21wdXRlZDogewogICAgLy8gVGhlIE1vbWVudEpTIHRpbWUgaW4gbG9jYWwgdGltZQogICAgbG9jYWxUaW1lOiB7CiAgICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICAgIGNvbnN0IG0gPSBNb21lbnQodGhpcy52YWx1ZSkKICAgICAgICBtLmxvY2FsKCkKICAgICAgICByZXR1cm4gbQogICAgICB9LAogICAgICBzZXQ6IGZ1bmN0aW9uIChuZXdWYWx1ZSkgewogICAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgbmV3VmFsdWUuZm9ybWF0KCkpCiAgICAgIH0KICAgIH0sCiAgICB0aW1lOiB7CiAgICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzLmxvY2FsVGltZS5mb3JtYXQoJ0hIOm1tOnNzJykKICAgICAgfQogICAgfSwKICAgIGRhdGU6IHsKICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxUaW1lLmZvcm1hdCgnWVlZWS1NTS1ERCcpCiAgICAgIH0KICAgIH0sCiAgICB0aW1lTWludXRlOiB7CiAgICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICAgIC8vIDAgbWVhbnMgMTI6MDAsIDcyMCBtZWFucyBtaWRuaWdodCwgMTQ0MCAoPTI0KjYwKSBtZWFucyAxMjowMCB0aGUgZGF5IGFmdGVyCiAgICAgICAgY29uc3QgdCA9IHRoaXMubG9jYWxUaW1lCiAgICAgICAgcmV0dXJuIHQuaG91cnMoKSA8IDEyID8gKHQuaG91cnMoKSArIDEyKSAqIDYwICsgdC5taW51dGVzKCkgOiAodC5ob3VycygpIC0gMTIpICogNjAgKyB0Lm1pbnV0ZXMoKQogICAgICB9LAogICAgICBzZXQ6IGZ1bmN0aW9uIChuZXdWYWx1ZSkgewogICAgICAgIHZhciB0ID0gTW9tZW50KHRoaXMuc2xpZGVyU3RhcnRUaW1lKQogICAgICAgIHQuYWRkKG5ld1ZhbHVlLCAnbWludXRlcycpCiAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCB0LmZvcm1hdCgpKQogICAgICB9CiAgICB9LAogICAgc2xpZGVyU3RhcnRUaW1lOiBmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnN0IHQgPSB0aGlzLmxvY2FsVGltZS5jbG9uZSgpCiAgICAgIGlmICh0LmhvdXJzKCkgPCAxMikgewogICAgICAgIHQuc3VidHJhY3QoMSwgJ2RheXMnKQogICAgICB9CiAgICAgIHQuaG91cnMoMTIpCiAgICAgIHQubWludXRlcygwKQogICAgICB0LnNlY29uZHMoMCkKICAgICAgdC5taWxsaXNlY29uZHMoMCkKICAgICAgcmV0dXJuIHQKICAgIH0sCiAgICBzbGlkZXJIaW50OiBmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnN0IHRtID0gdGhpcy50aW1lTWludXRlCiAgICAgIGNvbnN0IHN0b3AgPSB0aGlzLnN0b3BzW01hdGguZmxvb3IodG0gKiB0aGlzLnN0b3BzLmxlbmd0aCAvIDE0NDApXQogICAgICBpZiAoIXN0b3ApIHJldHVybiAnJwogICAgICBpZiAoc3RvcC5zdW5BbHQgPiAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHQoJ0RheWxpZ2h0JykKICAgICAgfQogICAgICBpZiAoc3RvcC5zdW5BbHQgPCAtMTYpIHsKICAgICAgICByZXR1cm4gc3RvcC5tb29uQWx0IDwgNSA/IHRoaXMuJHQoJ0RhcmsgbmlnaHQnKSA6IHRoaXMuJHQoJ01vb25saWdodCcpCiAgICAgIH0KICAgICAgcmV0dXJuIHRtID4gNzIwID8gdGhpcy4kdCgnRGF3bicpIDogdGhpcy4kdCgnVHdpbGlnaHQnKQogICAgfSwKICAgIGlzVGltZVBhdXNlZDogZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuc3RlbC50aW1lX3NwZWVkID09PSAwCiAgICB9LAogICAgdG9nZ2xlUGF1c2VUaW1lSWNvbjogZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcy5pc1RpbWVQYXVzZWQgPyAnbWRpLXBsYXknIDogJ21kaS1wYXVzZScKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLiRidXMuJG9uKCdSZXNldFRpbWUnLCB0aGlzLnJlc2V0VGltZSk7CiAgfSwKICBtZXRob2RzOiB7CiAgICByZXNldFRpbWU6IGZ1bmN0aW9uICgpIHsKICAgICAgY29uc29sZS5sb2coJ1Jlc2V0IHRpbWUnKQogICAgICBjb25zdCBtID0gTW9tZW50KCkKICAgICAgbS5sb2NhbCgpCiAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgbS5mb3JtYXQoKSkKICAgICAgdGhpcy5zeW5jaHJvbml6ZVRpbWUoKQogICAgfSwKICAgIHRvZ2dsZVBhdXNlVGltZTogZnVuY3Rpb24gKCkgewogICAgICB0aGlzLiRzdGVsLmNvcmUudGltZV9zcGVlZCA9ICh0aGlzLiRzdGVsLmNvcmUudGltZV9zcGVlZCA9PT0gMCkgPyAxIDogMAogICAgfSwKICAgIGluY1RpbWU6IGZ1bmN0aW9uICh1bml0KSB7CiAgICAgIHRoaXMuc3RhcnRJbmNUaW1lKDEsIHVuaXQpCiAgICB9LAogICAgZGVjVGltZTogZnVuY3Rpb24gKHVuaXQpIHsKICAgICAgdGhpcy5zdGFydEluY1RpbWUoLTEsIHVuaXQpCiAgICB9LAogICAgc3RhcnRJbmNUaW1lOiBmdW5jdGlvbiAodiwgdW5pdCkgewogICAgICBjb25zdCB0aGF0ID0gdGhpcwogICAgICBjbGlja1RpbWVvdXQgPSBzZXRUaW1lb3V0KF8gPT4gewogICAgICAgIGNvbnN0IHQgPSB0aGlzLmxvY2FsVGltZS5jbG9uZSgpCiAgICAgICAgdC5hZGQodiwgdW5pdCkKICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIHQuZm9ybWF0KCkpCiAgICAgICAgbmJDbGlja1JlcGVhdCsrCiAgICAgICAgdGhhdC5zdGFydEluY1RpbWUodiwgdW5pdCkKICAgICAgfSwgbmJDbGlja1JlcGVhdCA9PT0gMCA/IDAgOiAobmJDbGlja1JlcGVhdCA9PT0gMSA/IDUwMCA6IChuYkNsaWNrUmVwZWF0IDwgMTAgPyAxMDAgOiAobmJDbGlja1JlcGVhdCA8IDEwMCA/IDUwIDogMjApKSkpCiAgICB9LAogICAgc3RvcEluY1RpbWU6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKGNsaWNrVGltZW91dCkgewogICAgICAgIGNsZWFyVGltZW91dChjbGlja1RpbWVvdXQpCiAgICAgICAgY2xpY2tUaW1lb3V0ID0gdW5kZWZpbmVkCiAgICAgICAgbmJDbGlja1JlcGVhdCA9IDAKICAgICAgfQogICAgfSwKICAgIHN5bmNocm9uaXplVGltZTogZnVuY3Rpb24gKCkgewogICAgICBjb25zb2xlLmxvZygnU3luY2hyb25pemUgdGltZTonLCB0aGlzLnRpbWUpCiAgICAgIGNvbnNvbGUubG9nKCdTeW5jaHJvbml6ZSBkYXRlOicsIHRoaXMuZGF0ZSkKICAgICAgdGhpcy4kYnVzLiRlbWl0KCdBcHBTZW5kTWVzc2FnZScsICdWdWVfQ29tbWFuZCcsICdTeW5jaHJvbml6ZVRpbWU6JyArIHRoaXMudGltZSArICc6JyArIHRoaXMuZGF0ZSk7CiAgICB9LAogICAgLy8gMCBtZWFucyAxMjowMCwgNzIwIG1lYW5zIG1pZG5pZ2h0LCAxNDQwICg9MjQqNjApIG1lYW5zIDEyOjAwIHRoZSBkYXkgYWZ0ZXIKICAgIHRpbWVNaW51dGVSYW5nZVRvVVRDOiBmdW5jdGlvbiAodG0pIHsKICAgICAgcmV0dXJuIHRoaXMuc2xpZGVyU3RhcnRUaW1lLnRvRGF0ZSgpLmdldE1KRCgpICsgdG0gKiAxIC8gKDI0ICogNjApCiAgICB9LAogICAgcmVmcmVzaFN0b3BzOiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzLnN0b3BDYWNoZUtleS5zbGlkZXJTdGFydFRpbWUgPT09IHRoaXMuc2xpZGVyU3RhcnRUaW1lLmZvcm1hdCgpICYmIHRoaXMuc3RvcENhY2hlS2V5LmxvY2F0aW9uID09PSBKU09OLnN0cmluZ2lmeSh0aGlzLmxvY2F0aW9uKSkgewogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIGNvbnN0IHJlcyA9IFtdCiAgICAgIGNvbnN0IG5iU3RvcCA9IDQ5CiAgICAgIGNvbnN0IG9icyA9IHRoaXMuJHN0ZWwuY29yZS5vYnNlcnZlci5jbG9uZSgpCiAgICAgIGNvbnN0IHN1biA9IHRoaXMuJHN0ZWwuZ2V0T2JqKCdOQU1FIFN1bicpCiAgICAgIGNvbnN0IG1vb24gPSB0aGlzLiRzdGVsLmdldE9iaignTkFNRSBNb29uJykKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gbmJTdG9wOyArK2kpIHsKICAgICAgICBvYnMudXRjID0gdGhpcy50aW1lTWludXRlUmFuZ2VUb1VUQygxNDQwICogaSAvIG5iU3RvcCkKICAgICAgICBjb25zdCBzdW5BbHQgPSB0aGlzLiRzdGVsLmFucG0odGhpcy4kc3RlbC5jMnModGhpcy4kc3RlbC5jb252ZXJ0RnJhbWUob2JzLCAnSUNSRicsICdPQlNFUlZFRCcsIHN1bi5nZXRJbmZvKCdyYWRlYycsIG9icykpKVsxXSkgKiAxODAuMCAvIE1hdGguUEkKICAgICAgICBjb25zdCBtb29uQWx0ID0gdGhpcy4kc3RlbC5hbnBtKHRoaXMuJHN0ZWwuYzJzKHRoaXMuJHN0ZWwuY29udmVydEZyYW1lKG9icywgJ0lDUkYnLCAnT0JTRVJWRUQnLCBtb29uLmdldEluZm8oJ3JhZGVjJywgb2JzKSkpWzFdKSAqIDE4MC4wIC8gTWF0aC5QSQogICAgICAgIGNvbnN0IGJyaWdodG5lc3NGb3JBbHRpdHVkZSA9IGZ1bmN0aW9uIChzdW5BbHQsIG1vb25BbHQpIHsKICAgICAgICAgIGNvbnN0IG1vb25CcmlnaHRuZXNzID0gbW9vbkFsdCA8IDAgPyAwIDogMiAvIDM1ICogTWF0aC5taW4oMjAsIG1vb25BbHQpIC8gMjAKICAgICAgICAgIGlmIChzdW5BbHQgPiAwKSByZXR1cm4gTWF0aC5taW4oMTAsIDEgKyBzdW5BbHQpICsgbW9vbkJyaWdodG5lc3MKICAgICAgICAgIGlmIChzdW5BbHQgPCAtMTYpIHJldHVybiBtb29uQnJpZ2h0bmVzcwogICAgICAgICAgaWYgKHN1bkFsdCA8IC0xMCkgcmV0dXJuIDEgLyAzNSAqICgxNiArIHN1bkFsdCkgLyA2ICsgbW9vbkJyaWdodG5lc3MKICAgICAgICAgIHJldHVybiAoMSAtIDEgLyAzNSkgKiAoMTAgKyBzdW5BbHQpIC8gMTAgKyAxIC8gMzUgKyBtb29uQnJpZ2h0bmVzcwogICAgICAgIH0KICAgICAgICBjb25zdCBicmlnaHRuZXNzID0gTWF0aC5sb2cxMCgxICsgYnJpZ2h0bmVzc0ZvckFsdGl0dWRlKHN1bkFsdCwgbW9vbkFsdCkgKiAxMCkgLyAyCiAgICAgICAgcmVzLnB1c2goewogICAgICAgICAgcGVyY2VudDogaSAvIG5iU3RvcCwKICAgICAgICAgIHN0eWxlOiAnc3RvcC1jb2xvcjpyZ2IoNjQsMjA5LDI1NSk7c3RvcC1vcGFjaXR5OicgKyBicmlnaHRuZXNzLAogICAgICAgICAgc3VuQWx0OiBzdW5BbHQsCiAgICAgICAgICBtb29uQWx0OiBtb29uQWx0CiAgICAgICAgfSkKICAgICAgfQogICAgICBvYnMuZGVzdHJveSgpCiAgICAgIHRoaXMuc3RvcENhY2hlS2V5LnNsaWRlclN0YXJ0VGltZSA9IHRoaXMuc2xpZGVyU3RhcnRUaW1lLmZvcm1hdCgpCiAgICAgIHRoaXMuc3RvcENhY2hlS2V5LmxvY2F0aW9uID0gSlNPTi5zdHJpbmdpZnkodGhpcy5sb2NhdGlvbikKICAgICAgdGhpcy5zdG9wcyA9IHJlcwogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gKCkgewogICAgdGhpcy5yZWZyZXNoU3RvcHMoKQogICAgY29uc3QgdGhhdCA9IHRoaXMKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHRoYXQuc3RvcEluY1RpbWUoKQogICAgfSkKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIGZ1bmN0aW9uIChldmVudCkgewogICAgICB0aGF0LnN0b3BJbmNUaW1lKCkKICAgIH0pCiAgICB0aGlzLiRidXMuJGVtaXQoJ0FwcFNlbmRNZXNzYWdlJywgJ1Z1ZV9Db21tYW5kJywgJ2dldENsaWVudFNldHRpbmdzJykKICB9LAogIHdhdGNoOiB7CiAgICBzbGlkZXJTdGFydFRpbWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5yZWZyZXNoU3RvcHMoKQogICAgfSwKICAgIGxvY2F0aW9uOiBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMucmVmcmVzaFN0b3BzKCkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["date-time-picker.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"date-time-picker.vue","sourceRoot":"src/components","sourcesContent":["// Stellarium Web - Copyright (c) 2022 - Stellarium Labs SRL\n//\n// This program is licensed under the terms of the GNU AGPL v3, or\n// alternatively under a commercial licence.\n//\n// The terms of the AGPL v3 license can be found in the main directory of this\n// repository.\n\n<template>\n  <v-card width=\"400\" style=\"backdrop-filter: blur(5px); background-color: rgba(64, 64, 64, 0.5);\" class=\"dateTimePicker\">\n    <v-container>\n      <v-row justify=\"space-between\" no-gutters class=\"ma-3\">\n        <div>\n          <v-btn text icon class=\"up_down_bt\" style=\"margin-left: 16px\" @mousedown=\"incTime('years')\" @mouseup=\"synchronizeTime\" @touchstart.prevent=\"incTime('years')\" @touchend.prevent=\"synchronizeTime\"><v-icon>mdi-menu-up</v-icon></v-btn>\n          <v-btn text icon class=\"up_down_bt\" style=\"margin-left: 21px\" @mousedown=\"incTime('months')\" @mouseup=\"synchronizeTime\" @touchstart.prevent=\"incTime('months')\" @touchend.prevent=\"synchronizeTime\"><v-icon>mdi-menu-up</v-icon></v-btn>\n          <v-btn text icon class=\"up_down_bt\" style=\"margin-left: 8px\"  @mousedown=\"incTime('days')\" @mouseup=\"synchronizeTime\" @touchstart.prevent=\"incTime('days')\" @touchend.prevent=\"synchronizeTime  \"><v-icon>mdi-menu-up</v-icon></v-btn>\n          <h1>{{ date }}</h1>\n          <v-btn text icon class=\"up_down_bt\" style=\"margin-left: 16px\" @mousedown=\"decTime('years')\" @mouseup=\"synchronizeTime\" @touchstart.prevent=\"decTime('years')\" @touchend.prevent=\"synchronizeTime\"><v-icon>mdi-menu-down</v-icon></v-btn>\n          <v-btn text icon class=\"up_down_bt\" style=\"margin-left: 21px\" @mousedown=\"decTime('months')\" @mouseup=\"synchronizeTime\" @touchstart.prevent=\"decTime('months')\" @touchend.prevent=\"synchronizeTime  \"><v-icon>mdi-menu-down</v-icon></v-btn>\n          <v-btn text icon class=\"up_down_bt\" style=\"margin-left: 8px\"  @mousedown=\"decTime('days')\" @mouseup=\"synchronizeTime\" @touchstart.prevent=\"decTime('days')\" @touchend.prevent=\"synchronizeTime  \"><v-icon>mdi-menu-down</v-icon></v-btn>\n        </div>\n        <div>\n        <div>\n        <v-tooltip top>\n          <template v-slot:activator=\"{ on }\">\n            <v-btn text icon @click=\"resetTime\" style=\"margin-top: 5px\" v-on=\"on\"><v-icon>mdi-history</v-icon></v-btn>\n          </template>\n          <span>{{ $t('Back to real time') }}</span>\n        </v-tooltip>\n        </div>\n        <div>\n        <v-tooltip top>\n          <template v-slot:activator=\"{ on }\">\n            <v-btn text icon @click=\"togglePauseTime\" style=\"margin-top: 0px\" v-on=\"on\"><v-icon>{{ togglePauseTimeIcon }}</v-icon></v-btn>\n          </template>\n          <span>{{ $t('Pause/unpause time') }}</span>\n        </v-tooltip>\n        </div>\n        </div>\n        <div>\n          <v-btn text icon class=\"up_down_bt\" @mousedown=\"incTime('hours')\" @mouseup=\"synchronizeTime\" @touchstart.prevent=\"incTime('hours')\" @touchend.prevent=\"synchronizeTime\"><v-icon>mdi-menu-up</v-icon></v-btn>\n          <v-btn text icon class=\"up_down_bt ml-1\" @mousedown=\"incTime('minutes')\" @mouseup=\"synchronizeTime\" @touchstart.prevent=\"incTime('minutes')\" @touchend.prevent=\"synchronizeTime\"><v-icon>mdi-menu-up</v-icon></v-btn>\n          <v-btn text icon class=\"up_down_bt ml-1\" @mousedown=\"incTime('seconds')\" @mouseup=\"synchronizeTime\" @touchstart.prevent=\"incTime('seconds')\" @touchend.prevent=\"synchronizeTime\"><v-icon>mdi-menu-up</v-icon></v-btn>\n          <h1 class=\"ml-2\">{{ time }}</h1>\n          <v-btn text icon class=\"up_down_bt\" @mousedown=\"decTime('hours')\" @mouseup=\"synchronizeTime\" @touchstart.prevent=\"decTime('hours')\" @touchend.prevent=\"synchronizeTime\"><v-icon>mdi-menu-down</v-icon></v-btn>\n          <v-btn text icon class=\"up_down_bt ml-1\" @mousedown=\"decTime('minutes')\" @mouseup=\"synchronizeTime\" @touchstart.prevent=\"decTime('minutes')\" @touchend.prevent=\"synchronizeTime\"><v-icon>mdi-menu-down</v-icon></v-btn>\n          <v-btn text icon class=\"up_down_bt ml-1\" @mousedown=\"decTime('seconds')\" @mouseup=\"synchronizeTime\" @touchstart.prevent=\"decTime('seconds')\" @touchend.prevent=\"synchronizeTime\"><v-icon>mdi-menu-down</v-icon></v-btn>\n        </div>\n      </v-row>\n    </v-container>\n    <div style=\"padding: 20px\">\n      <div style=\"position: absolute\">\n        <svg height=\"30\" width=\"360\">\n          <defs>\n            <linearGradient id=\"grad1\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n              <stop v-for=\"stop in stops\" :offset=\"stop.percent\" :style=\"stop.style\" :key=\"stop.percent\"/>\n            </linearGradient>\n          </defs>\n          <rect width=\"100%\" height=\"100%\" fill=\"url(#grad1)\" />\n        </svg>\n      </div>\n      <v-slider min=\"0\" max=\"1439\" style=\"padding: 0px; width: 360px;\" v-model=\"timeMinute\" :hint=\"sliderHint\" persistent-hint \n        @mouseup=\"synchronizeTime\" @mouseleave=\"synchronizeTime\" @touchend=\"synchronizeTime\" @touchcancel=\"synchronizeTime\">\n      </v-slider>\n    </div>\n  </v-card>\n</template>\n\n<script>\n\nimport Moment from 'moment'\nvar clickTimeout\nvar nbClickRepeat = 0\n\nexport default {\n  data: function () {\n    return {\n      stops: [],\n      stopCacheKey: {\n        sliderStartTime: undefined,\n        location: undefined\n      }\n    }\n  },\n  props: ['value', 'location'],\n  computed: {\n    // The MomentJS time in local time\n    localTime: {\n      get: function () {\n        const m = Moment(this.value)\n        m.local()\n        return m\n      },\n      set: function (newValue) {\n        this.$emit('input', newValue.format())\n      }\n    },\n    time: {\n      get: function () {\n        return this.localTime.format('HH:mm:ss')\n      }\n    },\n    date: {\n      get: function () {\n        return this.localTime.format('YYYY-MM-DD')\n      }\n    },\n    timeMinute: {\n      get: function () {\n        // 0 means 12:00, 720 means midnight, 1440 (=24*60) means 12:00 the day after\n        const t = this.localTime\n        return t.hours() < 12 ? (t.hours() + 12) * 60 + t.minutes() : (t.hours() - 12) * 60 + t.minutes()\n      },\n      set: function (newValue) {\n        var t = Moment(this.sliderStartTime)\n        t.add(newValue, 'minutes')\n        this.$emit('input', t.format())\n      }\n    },\n    sliderStartTime: function () {\n      const t = this.localTime.clone()\n      if (t.hours() < 12) {\n        t.subtract(1, 'days')\n      }\n      t.hours(12)\n      t.minutes(0)\n      t.seconds(0)\n      t.milliseconds(0)\n      return t\n    },\n    sliderHint: function () {\n      const tm = this.timeMinute\n      const stop = this.stops[Math.floor(tm * this.stops.length / 1440)]\n      if (!stop) return ''\n      if (stop.sunAlt > 0) {\n        return this.$t('Daylight')\n      }\n      if (stop.sunAlt < -16) {\n        return stop.moonAlt < 5 ? this.$t('Dark night') : this.$t('Moonlight')\n      }\n      return tm > 720 ? this.$t('Dawn') : this.$t('Twilight')\n    },\n    isTimePaused: function () {\n      return this.$store.state.stel.time_speed === 0\n    },\n    togglePauseTimeIcon: function () {\n      return this.isTimePaused ? 'mdi-play' : 'mdi-pause'\n    }\n  },\n  created() {\n    this.$bus.$on('ResetTime', this.resetTime);\n  },\n  methods: {\n    resetTime: function () {\n      console.log('Reset time')\n      const m = Moment()\n      m.local()\n      this.$emit('input', m.format())\n      this.synchronizeTime()\n    },\n    togglePauseTime: function () {\n      this.$stel.core.time_speed = (this.$stel.core.time_speed === 0) ? 1 : 0\n    },\n    incTime: function (unit) {\n      this.startIncTime(1, unit)\n    },\n    decTime: function (unit) {\n      this.startIncTime(-1, unit)\n    },\n    startIncTime: function (v, unit) {\n      const that = this\n      clickTimeout = setTimeout(_ => {\n        const t = this.localTime.clone()\n        t.add(v, unit)\n        this.$emit('input', t.format())\n        nbClickRepeat++\n        that.startIncTime(v, unit)\n      }, nbClickRepeat === 0 ? 0 : (nbClickRepeat === 1 ? 500 : (nbClickRepeat < 10 ? 100 : (nbClickRepeat < 100 ? 50 : 20))))\n    },\n    stopIncTime: function () {\n      if (clickTimeout) {\n        clearTimeout(clickTimeout)\n        clickTimeout = undefined\n        nbClickRepeat = 0\n      }\n    },\n    synchronizeTime: function () {\n      console.log('Synchronize time:', this.time)\n      console.log('Synchronize date:', this.date)\n      this.$bus.$emit('AppSendMessage', 'Vue_Command', 'SynchronizeTime:' + this.time + ':' + this.date);\n    },\n    // 0 means 12:00, 720 means midnight, 1440 (=24*60) means 12:00 the day after\n    timeMinuteRangeToUTC: function (tm) {\n      return this.sliderStartTime.toDate().getMJD() + tm * 1 / (24 * 60)\n    },\n    refreshStops: function () {\n      if (this.stopCacheKey.sliderStartTime === this.sliderStartTime.format() && this.stopCacheKey.location === JSON.stringify(this.location)) {\n        return\n      }\n      const res = []\n      const nbStop = 49\n      const obs = this.$stel.core.observer.clone()\n      const sun = this.$stel.getObj('NAME Sun')\n      const moon = this.$stel.getObj('NAME Moon')\n      for (let i = 0; i <= nbStop; ++i) {\n        obs.utc = this.timeMinuteRangeToUTC(1440 * i / nbStop)\n        const sunAlt = this.$stel.anpm(this.$stel.c2s(this.$stel.convertFrame(obs, 'ICRF', 'OBSERVED', sun.getInfo('radec', obs)))[1]) * 180.0 / Math.PI\n        const moonAlt = this.$stel.anpm(this.$stel.c2s(this.$stel.convertFrame(obs, 'ICRF', 'OBSERVED', moon.getInfo('radec', obs)))[1]) * 180.0 / Math.PI\n        const brightnessForAltitude = function (sunAlt, moonAlt) {\n          const moonBrightness = moonAlt < 0 ? 0 : 2 / 35 * Math.min(20, moonAlt) / 20\n          if (sunAlt > 0) return Math.min(10, 1 + sunAlt) + moonBrightness\n          if (sunAlt < -16) return moonBrightness\n          if (sunAlt < -10) return 1 / 35 * (16 + sunAlt) / 6 + moonBrightness\n          return (1 - 1 / 35) * (10 + sunAlt) / 10 + 1 / 35 + moonBrightness\n        }\n        const brightness = Math.log10(1 + brightnessForAltitude(sunAlt, moonAlt) * 10) / 2\n        res.push({\n          percent: i / nbStop,\n          style: 'stop-color:rgb(64,209,255);stop-opacity:' + brightness,\n          sunAlt: sunAlt,\n          moonAlt: moonAlt\n        })\n      }\n      obs.destroy()\n      this.stopCacheKey.sliderStartTime = this.sliderStartTime.format()\n      this.stopCacheKey.location = JSON.stringify(this.location)\n      this.stops = res\n    }\n  },\n  mounted: function () {\n    this.refreshStops()\n    const that = this\n    window.addEventListener('mouseup', function (event) {\n      that.stopIncTime()\n    })\n    window.addEventListener('touchend', function (event) {\n      that.stopIncTime()\n    })\n    this.$bus.$emit('AppSendMessage', 'Vue_Command', 'getClientSettings')\n  },\n  watch: {\n    sliderStartTime: function () {\n      this.refreshStops()\n    },\n    location: function () {\n      this.refreshStops()\n    }\n  }\n}\n</script>\n\n<style>\n.up_down_bt {\n  margin-bottom: -10px!important;\n  margin-top: -10px!important;\n  margin-left: 0px;\n  margin-right: 0px!important;\n}\n\n.dateTimePicker {\n  pointer-events: auto;\n  position: absolute;\n  \n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n}\n</style>\n"]}]}