{"remainingRequest":"/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/src/components/location-dialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/app/src/components/location-dialog.vue","mtime":1749023967925},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":1707125360000},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1707125360000},{"path":"/app/node_modules/vue-loader/lib/index.js","mtime":1707125450000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBMb2NhdGlvbk1nciBmcm9tICdAL2NvbXBvbmVudHMvbG9jYXRpb24tbWdyLnZ1ZScKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VBdXRvTG9jYXRpb246IHRydWUsCiAgICAgIG1hbnVhbExhdGl0dWRlOiAnJywKICAgICAgbWFudWFsTG9uZ2l0dWRlOiAnJywKICAgICAgbG9jYXRpb25MYXQ6ICcnLAogICAgICBsb2NhdGlvbkxvbjogJycsCiAgICB9CgogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC8vIHVzZUF1dG9Mb2NhdGlvbjogewogICAgLy8gICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgIC8vICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUudXNlQXV0b0xvY2F0aW9uCiAgICAvLyAgIH0sCiAgICAvLyAgIHNldDogZnVuY3Rpb24gKGIpIHsKICAgIC8vICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFVzZUF1dG9Mb2NhdGlvbicsIGIpCiAgICAvLyAgIH0KICAgIC8vIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuJGJ1cy4kZW1pdCgnVnVlX0NvbW1hbmQnLCAnbG9jYWxNZXNzYWdlJyk7IC8vIOiOt+WPluS9jee9ruS/oeaBrwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuJGJ1cy4kb24oJ3Jlc2V0TG9jYXRpb24nLCB0aGlzLnJlc2V0TG9jYXRpb24pOwogICAgdGhpcy4kYnVzLiRvbignc2V0TG9jYXRpb25MYXRBbmRMb24nLCB0aGlzLnNldExvY2F0aW9uTGF0QW5kTG9uKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHJlc2V0TG9jYXRpb246IGZ1bmN0aW9uIChsYXQsIGxuZykgewogICAgICBsYXQgPSBOdW1iZXIobGF0KTsKICAgICAgbG5nID0gTnVtYmVyKGxuZyk7CiAgICAgIGlmIChpc05hTihsYXQpIHx8IGlzTmFOKGxuZykpIHsKICAgICAgICB0aGlzLm1hbnVhbExhdGl0dWRlID0gJyc7CiAgICAgICAgdGhpcy5tYW51YWxMb25naXR1ZGUgPSAnJzsKICAgICAgICB0aGlzLnVzZUF1dG9Mb2NhdGlvbiA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5tYW51YWxMYXRpdHVkZSA9IFN0cmluZyhsYXQpOwogICAgICAgIHRoaXMubWFudWFsTG9uZ2l0dWRlID0gU3RyaW5nKGxuZyk7CiAgICAgICAgdGhpcy51c2VBdXRvTG9jYXRpb24gPSBmYWxzZTsKICAgICAgfQogICAgICB0aGlzLnNhdmVNYW51YWxDb29yZGluYXRlcygpOwogICAgfSwKICAgIHNldExvY2F0aW9uTGF0QW5kTG9uOiBmdW5jdGlvbiAobGF0LCBsbmcpIHsKICAgICAgdGhpcy4kYnVzLiRlbWl0KCdTZW5kQ29uc29sZUxvZ01zZycsICdzZXRMb2NhdGlvbkxhdEFuZExvbjonICsgbGF0ICsgJywnICsgbG5nLCAnaW5mbycpCiAgICAgIHRoaXMubG9jYXRpb25MYXQgPSBsYXQ7CiAgICAgIHRoaXMubG9jYXRpb25Mb24gPSBsbmc7CiAgICAgIGlmICh0aGlzLnVzZUF1dG9Mb2NhdGlvbikgewogICAgICAgIHRoaXMubWFudWFsTGF0aXR1ZGUgPSBsYXQ7CiAgICAgICAgdGhpcy5tYW51YWxMb25naXR1ZGUgPSBsbmc7CiAgICAgICAgLy8gdGhpcy5zYXZlTWFudWFsQ29vcmRpbmF0ZXMoKTsKICAgICAgfQogICAgfSwKICAgIHNldExvY2F0aW9uOiBmdW5jdGlvbiAobG9jKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Q3VycmVudExvY2F0aW9uJywgbG9jKQogICAgfSwKICAgIHNhdmVNYW51YWxDb29yZGluYXRlczogZnVuY3Rpb24gKCkgewogICAgICBjb25zdCBsYXQgPSBwYXJzZUZsb2F0KHRoaXMubWFudWFsTGF0aXR1ZGUudHJpbSgpKTsKICAgICAgY29uc3QgbG5nID0gcGFyc2VGbG9hdCh0aGlzLm1hbnVhbExvbmdpdHVkZS50cmltKCkpOwogICAgICB0aGlzLiRidXMuJGVtaXQoJ1BvbGFyUG9pbnRBbHRpdHVkZScsIGxhdCkKICAgICAgdGhpcy4kYnVzLiRlbWl0KCdTZW5kQ29uc29sZUxvZ01zZycsICdTZXQgQ3VycmVudCBMb2NhdGlvbjonICsgbGF0ICsgJywnICsgbG5nLCAnaW5mbycpCiAgICAgIGNvbnN0IGxvYyA9IHsKICAgICAgICBzaG9ydF9uYW1lOiAnVW5rbm93bicsCiAgICAgICAgY291bnRyeTogJ1Vua25vd24nLAogICAgICAgIGxuZzogbG5nLAogICAgICAgIGxhdDogbGF0LAogICAgICAgIGFsdDogMCwgCiAgICAgICAgYWNjdXJhY3k6IDAsIAogICAgICAgIHN0cmVldF9hZGRyZXNzOiAnJwogICAgICB9CiAgICAgIHRoaXMuc2V0TG9jYXRpb24obG9jKQogICAgICB0aGlzLiRidXMuJGVtaXQoJ0FwcFNlbmRNZXNzYWdlJywgJ1Z1ZV9Db21tYW5kJywgJ3NhdmVUb0NvbmZpZ0ZpbGU6Q29vcmRpbmF0ZXM6JysgbGF0ICsgJywnICsgbG5nKTsKICAgICAgdGhpcy4kYnVzLiRlbWl0KCdTaG93UG9zaXRpb25JbmZvJywgbGF0LCBsbmcpOwogICAgICBpZiAodGhpcy51c2VBdXRvTG9jYXRpb24pIHsKICAgICAgICB0aGlzLnVzZUF1dG9Mb2NhdGlvbiA9IGZhbHNlOwogICAgICB9CgogICAgfSwKICAgIGhhbmRsZUF1dG9Mb2NhdGlvbkNoYW5nZTogZnVuY3Rpb24gKG5ld1ZhbCkgewogICAgICB0aGlzLiRidXMuJGVtaXQoJ1NlbmRDb25zb2xlTG9nTXNnJywgJ2hhbmRsZUF1dG9Mb2NhdGlvbkNoYW5nZTonICsgbmV3VmFsLCAnaW5mbycpCiAgICAgIGlmIChuZXdWYWwpIHsKICAgICAgICB0aGlzLiRidXMuJGVtaXQoJ1NlbmRDb25zb2xlTG9nTXNnJywgJ+W9k+WJjeS9jee9rjonICsgdGhpcy5sb2NhdGlvbkxhdCArICcsJyArIHRoaXMubG9jYXRpb25Mb24sICdpbmZvJykKICAgICAgICBsZXQgbGF0ID0gcGFyc2VGbG9hdCh0aGlzLmxvY2F0aW9uTGF0LnRyaW0oKSk7CiAgICAgICAgbGV0IGxuZyA9IHBhcnNlRmxvYXQodGhpcy5sb2NhdGlvbkxvbi50cmltKCkpOwogICAgICAgIHRoaXMuJGJ1cy4kZW1pdCgnU2VuZENvbnNvbGVMb2dNc2cnLCAn5b2T5YmN5L2N572uOicgKyBsYXQgKyAnLCcgKyBsbmcsICdpbmZvJykKICAgICAgICAvLyDmiafooYzkvaDmg7PopoHnmoTmk43kvZwKICAgICAgICBpZiAoaXNOYU4obGF0KSB8fCBpc05hTihsbmcpKSB7CiAgICAgICAgICB0aGlzLiRidXMuJGVtaXQoJ3Nob3dNc2dCb3gnLCAnTG9jYXRpb24gaW5mb3JtYXRpb24gbm90IG9idGFpbmVkLCBwbGVhc2UgY2hlY2sgbG9jYXRpb24gcGVybWlzc2lvbnMnLCAnZXJyb3InKQogICAgICAgICAgdGhpcy4kYnVzLiRlbWl0KCdTZW5kQ29uc29sZUxvZ01zZycsICdMb2NhdGlvbiBpbmZvcm1hdGlvbiBub3Qgb2J0YWluZWQsIHBsZWFzZSBjaGVjayBsb2NhdGlvbiBwZXJtaXNzaW9ucycsICdlcnJvcicpCiAgICAgICAgICB0aGlzLnVzZUF1dG9Mb2NhdGlvbiA9IGZhbHNlOwogICAgICAgIH1lbHNlewogICAgICAgICAgdGhpcy5tYW51YWxMYXRpdHVkZSA9IHRoaXMubG9jYXRpb25MYXQ7CiAgICAgICAgICB0aGlzLm1hbnVhbExvbmdpdHVkZSA9IHRoaXMubG9jYXRpb25Mb247CiAgICAgICAgICBsYXQgPSBwYXJzZUZsb2F0KHRoaXMubWFudWFsTGF0aXR1ZGUudHJpbSgpKTsKICAgICAgICAgIGxuZyA9IHBhcnNlRmxvYXQodGhpcy5tYW51YWxMb25naXR1ZGUudHJpbSgpKTsKICAgICAgICAgIHRoaXMuJGJ1cy4kZW1pdCgnUG9sYXJQb2ludEFsdGl0dWRlJywgbGF0KQogICAgICAgICAgdGhpcy4kYnVzLiRlbWl0KCdTZW5kQ29uc29sZUxvZ01zZycsICdTZXQgQ3VycmVudCBMb2NhdGlvbjonICsgbGF0ICsgJywnICsgbG5nLCAnaW5mbycpCiAgICAgICAgICBjb25zdCBsb2MgPSB7CiAgICAgICAgICAgIHNob3J0X25hbWU6ICdVbmtub3duJywKICAgICAgICAgICAgY291bnRyeTogJ1Vua25vd24nLAogICAgICAgICAgICBsbmc6IGxuZywKICAgICAgICAgICAgbGF0OiBsYXQsCiAgICAgICAgICAgIGFsdDogMCwgCiAgICAgICAgICAgIGFjY3VyYWN5OiAwLCAKICAgICAgICAgICAgc3RyZWV0X2FkZHJlc3M6ICcnCiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLnNldExvY2F0aW9uKGxvYykKICAgICAgICAgIC8vIHRoaXMuJGJ1cy4kZW1pdCgnQXBwU2VuZE1lc3NhZ2UnLCAnVnVlX0NvbW1hbmQnLCAnc2F2ZVRvQ29uZmlnRmlsZTpDb29yZGluYXRlczonKyBsYXQgKyAnLCcgKyBsbmcpOwogICAgICAgICAgdGhpcy4kYnVzLiRlbWl0KCdTaG93UG9zaXRpb25JbmZvJywgbGF0LCBsbmcpOwogICAgICAgICAgdGhpcy4kYnVzLiRlbWl0KCdTZW5kQ29uc29sZUxvZ01zZycsICdTZXQgQ3VycmVudCBMb2NhdGlvbjonICsgbGF0ICsgJywnICsgbG5nLCAnaW5mbycpCiAgICAgICAgfQogICAgICB9CiAgICB9LAogIH0sCiAgY29tcG9uZW50czogeyBMb2NhdGlvbk1nciB9LAogIHdhdGNoOiB7CiAgICB1c2VBdXRvTG9jYXRpb246IGZ1bmN0aW9uIChuZXdWYWwsIG9sZFZhbCkgewogICAgICAvLyDov5nkuKrlh73mlbDlsIblnKggdXNlQXV0b0xvY2F0aW9uIOaUueWPmOaXtuiiq+iwg+eUqAogICAgICAvLyBuZXdWYWwg5pivIHVzZUF1dG9Mb2NhdGlvbiDnmoTmlrDlgLwKICAgICAgLy8gb2xkVmFsIOaYryB1c2VBdXRvTG9jYXRpb24g55qE5pen5YC8CiAgICAgIGNvbnNvbGUubG9nKCd1c2VBdXRvTG9jYXRpb24gY2hhbmdlZCBmcm9tJywgb2xkVmFsLCAndG8nLCBuZXdWYWwpOwogICAgfQogIH0KfQo="},{"version":3,"sources":["location-dialog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"location-dialog.vue","sourceRoot":"src/components","sourcesContent":["// Stellarium Web - Copyright (c) 2022 - Stellarium Labs SRL\n//\n// This program is licensed under the terms of the GNU AGPL v3, or\n// alternatively under a commercial licence.\n//\n// The terms of the AGPL v3 license can be found in the main directory of this\n// repository.\n\n<template>\n<v-dialog max-width=\"600\" v-model=\"$store.state.showLocationDialog\">\n  <v-container v-if=\"$store.state.showLocationDialog\" class=\"secondary white--text\">\n    <v-row>\n      <v-col cols=\"4\">\n        <v-text-field v-model=\"manualLatitude\" label=\"Latitude\" placeholder=\"Enter latitude\"></v-text-field>\n      </v-col>\n      <v-col cols=\"4\">\n        <v-text-field v-model=\"manualLongitude\" label=\"Longitude\" placeholder=\"Enter longitude\"></v-text-field>\n      </v-col>\n      <v-col cols=\"4\">\n        <v-spacer></v-spacer>\n        <v-btn @click=\"saveManualCoordinates\" color=\"primary\">Save Manual Coordinates</v-btn>\n      </v-col>\n    </v-row>\n    <v-card color=\"secondary\" flat>\n      <v-switch :label=\"$t('Use Autolocation')\" v-model=\"useAutoLocation\" @change=\"handleAutoLocationChange\"></v-switch>\n    </v-card>\n    <location-mgr v-on:locationSelected=\"setLocation\" :knownLocations=\"[]\" :startLocation=\"$store.state.currentLocation\" :realLocation=\"$store.state.autoDetectedLocation\"></location-mgr>\n    \n  </v-container>\n</v-dialog>\n</template>\n\n<script>\nimport LocationMgr from '@/components/location-mgr.vue'\n\nexport default {\n  data: function () {\n    return {\n      useAutoLocation: true,\n      manualLatitude: '',\n      manualLongitude: '',\n      locationLat: '',\n      locationLon: '',\n    }\n\n  },\n  computed: {\n    // useAutoLocation: {\n    //   get: function () {\n    //     return this.$store.state.useAutoLocation\n    //   },\n    //   set: function (b) {\n    //     this.$store.commit('setUseAutoLocation', b)\n    //   }\n    // }\n  },\n  mounted: function () {\n    this.$bus.$emit('Vue_Command', 'localMessage'); // 获取位置信息\n  },\n  created() {\n    this.$bus.$on('resetLocation', this.resetLocation);\n    this.$bus.$on('setLocationLatAndLon', this.setLocationLatAndLon);\n  },\n  methods: {\n    resetLocation: function (lat, lng) {\n      lat = Number(lat);\n      lng = Number(lng);\n      if (isNaN(lat) || isNaN(lng)) {\n        this.manualLatitude = '';\n        this.manualLongitude = '';\n        this.useAutoLocation = true;\n      } else {\n        this.manualLatitude = String(lat);\n        this.manualLongitude = String(lng);\n        this.useAutoLocation = false;\n      }\n      this.saveManualCoordinates();\n    },\n    setLocationLatAndLon: function (lat, lng) {\n      this.$bus.$emit('SendConsoleLogMsg', 'setLocationLatAndLon:' + lat + ',' + lng, 'info')\n      this.locationLat = lat;\n      this.locationLon = lng;\n      if (this.useAutoLocation) {\n        this.manualLatitude = lat;\n        this.manualLongitude = lng;\n        // this.saveManualCoordinates();\n      }\n    },\n    setLocation: function (loc) {\n      this.$store.commit('setCurrentLocation', loc)\n    },\n    saveManualCoordinates: function () {\n      const lat = parseFloat(this.manualLatitude.trim());\n      const lng = parseFloat(this.manualLongitude.trim());\n      this.$bus.$emit('PolarPointAltitude', lat)\n      this.$bus.$emit('SendConsoleLogMsg', 'Set Current Location:' + lat + ',' + lng, 'info')\n      const loc = {\n        short_name: 'Unknown',\n        country: 'Unknown',\n        lng: lng,\n        lat: lat,\n        alt: 0, \n        accuracy: 0, \n        street_address: ''\n      }\n      this.setLocation(loc)\n      this.$bus.$emit('AppSendMessage', 'Vue_Command', 'saveToConfigFile:Coordinates:'+ lat + ',' + lng);\n      this.$bus.$emit('ShowPositionInfo', lat, lng);\n      if (this.useAutoLocation) {\n        this.useAutoLocation = false;\n      }\n\n    },\n    handleAutoLocationChange: function (newVal) {\n      this.$bus.$emit('SendConsoleLogMsg', 'handleAutoLocationChange:' + newVal, 'info')\n      if (newVal) {\n        this.$bus.$emit('SendConsoleLogMsg', '当前位置:' + this.locationLat + ',' + this.locationLon, 'info')\n        let lat = parseFloat(this.locationLat.trim());\n        let lng = parseFloat(this.locationLon.trim());\n        this.$bus.$emit('SendConsoleLogMsg', '当前位置:' + lat + ',' + lng, 'info')\n        // 执行你想要的操作\n        if (isNaN(lat) || isNaN(lng)) {\n          this.$bus.$emit('showMsgBox', 'Location information not obtained, please check location permissions', 'error')\n          this.$bus.$emit('SendConsoleLogMsg', 'Location information not obtained, please check location permissions', 'error')\n          this.useAutoLocation = false;\n        }else{\n          this.manualLatitude = this.locationLat;\n          this.manualLongitude = this.locationLon;\n          lat = parseFloat(this.manualLatitude.trim());\n          lng = parseFloat(this.manualLongitude.trim());\n          this.$bus.$emit('PolarPointAltitude', lat)\n          this.$bus.$emit('SendConsoleLogMsg', 'Set Current Location:' + lat + ',' + lng, 'info')\n          const loc = {\n            short_name: 'Unknown',\n            country: 'Unknown',\n            lng: lng,\n            lat: lat,\n            alt: 0, \n            accuracy: 0, \n            street_address: ''\n          }\n          this.setLocation(loc)\n          // this.$bus.$emit('AppSendMessage', 'Vue_Command', 'saveToConfigFile:Coordinates:'+ lat + ',' + lng);\n          this.$bus.$emit('ShowPositionInfo', lat, lng);\n          this.$bus.$emit('SendConsoleLogMsg', 'Set Current Location:' + lat + ',' + lng, 'info')\n        }\n      }\n    },\n  },\n  components: { LocationMgr },\n  watch: {\n    useAutoLocation: function (newVal, oldVal) {\n      // 这个函数将在 useAutoLocation 改变时被调用\n      // newVal 是 useAutoLocation 的新值\n      // oldVal 是 useAutoLocation 的旧值\n      console.log('useAutoLocation changed from', oldVal, 'to', newVal);\n    }\n  }\n}\n</script>\n\n<style>\n</style>\n"]}]}