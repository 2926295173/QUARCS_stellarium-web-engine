{"remainingRequest":"/home/quarcs/workspace/QUARCS/QUARCS_stellarium-web-engine/apps/web-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/quarcs/workspace/QUARCS/QUARCS_stellarium-web-engine/apps/web-frontend/src/components/CircularButton.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/quarcs/workspace/QUARCS/QUARCS_stellarium-web-engine/apps/web-frontend/src/components/CircularButton.vue","mtime":1759997160536},{"path":"/home/quarcs/workspace/QUARCS/QUARCS_stellarium-web-engine/apps/web-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1707125360000},{"path":"/home/quarcs/workspace/QUARCS/QUARCS_stellarium-web-engine/apps/web-frontend/node_modules/thread-loader/dist/cjs.js","mtime":1707125360000},{"path":"/home/quarcs/workspace/QUARCS/QUARCS_stellarium-web-engine/apps/web-frontend/node_modules/babel-loader/lib/index.js","mtime":1707125360000},{"path":"/home/quarcs/workspace/QUARCS/QUARCS_stellarium-web-engine/apps/web-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1707125360000},{"path":"/home/quarcs/workspace/QUARCS/QUARCS_stellarium-web-engine/apps/web-frontend/node_modules/vue-loader/lib/index.js","mtime":1707125450000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcHJvZ3Jlc3M6IDAsCiAgICAgIC8vIGNpcmN1bWZlcmVuY2U6IDMzOS4yOTIsCiAgICAgIHJhZGl1czogMzAsIC8vIOWchueahOWNiuW+hAogICAgICBzdHJva2VXaWR0aDogNywgLy8g5ZyG546v55qE57q/5a69CiAgICAgIENhcHR1cmVFeHBUaW1lOiAxLAogICAgICBhbmltYXRpb25EdXJhdGlvbjogMSwgLy8g5Yqo55S75pe26ZW/5Li6MTAwMOavq+enku+8iDHnp5LvvIkKICAgICAgYW5pbWF0aW9uU3RhcnRUaW1lOiAwLCAvLyDliqjnlLvlvIDlp4vml7bpl7QKICAgICAgaXNDbGlja2VkOiBmYWxzZSwKCiAgICAgIGxvbmdQcmVzc1RocmVzaG9sZDogMTAwMCwKICAgICAgbG9uZ1ByZXNzVGltZXI6IG51bGwsCiAgICAgIFByZXNzVGltZXN0YW1wOiAwLAoKICAgICAgaXNMb25nUHJlc3M6IGZhbHNlLAogICAgICBsb25nUHJlc3NQcm9ncmVzczogMCwKCiAgICAgIE1haW5DYW1lcmFDb25uZWN0OiBmYWxzZSwKICAgICAgaXNQcm9jZXNzaW5nOiBmYWxzZSwgLy8g5paw5aKe54q25oCB5Y+Y6YeP77yM6KGo56S65piv5ZCm5q2j5Zyo5aSE55CGCgogICAgICBpc0J1dHRvbkRpc2FibGVkOiBmYWxzZSwgLy8g5ouN5pGE5oyJ6ZKu5piv5ZCm56aB55SoCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuJGJ1cy4kb24oJ0V4cG9zdXJlQ29tcGxldGVkJywgdGhpcy5vdmVyUHJvZ3Jlc3MpOwogICAgdGhpcy4kYnVzLiRvbignU2V0RXhwVGltZScsdGhpcy5TZXREdXJhdGlvbik7CiAgICB0aGlzLiRidXMuJG9uKCdDYW1lcmFJbkV4cG9zdXJpbmcnLHRoaXMuc2V0SW5Qcm9ncmVzcyk7CiAgICB0aGlzLiRidXMuJG9uKCdNYWluQ2FtZXJhQ29ubmVjdGVkJywgdGhpcy5NYWluQ2FtZXJhQ29ubmVjdGVkKTsKICAgIHRoaXMuJGJ1cy4kb24oJ2Rpc2FibGVDYXB0dXJlQnV0dG9uJywgdGhpcy5kaXNhYmxlQ2FwdHVyZUJ1dHRvbik7CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy4kYnVzLiRlbWl0KCdBcHBTZW5kTWVzc2FnZScsICdWdWVfQ29tbWFuZCcsICdnZXRDYXB0dXJlU3RhdHVzJyk7CiAgfSwKICBjb21wdXRlZDogewogICAgc3ZnU2l6ZSgpIHsKICAgICAgLy8gU1ZH55qE5aSn5bCP5bqU6K+l6Laz5aSf5YyF5ZCr5ZyG5b2i5oyJ6ZKu5Y+K5YW26L655qGGCiAgICAgIHJldHVybiB0aGlzLnJhZGl1cyAqIDIgKyB0aGlzLnN0cm9rZVdpZHRoICogMjsKICAgIH0sCiAgICBjaXJjdW1mZXJlbmNlKCkgewogICAgICAvLyDorqHnrpflnIblkajplb8KICAgICAgcmV0dXJuIDIgKiBNYXRoLlBJICogdGhpcy5yYWRpdXM7CiAgICB9LAogICAgcHJvZ3Jlc3NUZXh0KCkgewogICAgICByZXR1cm4gdGhpcy5pc0NsaWNrZWQgPyBgJHsodGhpcy5wcm9ncmVzcyAqIDEwMCkudG9GaXhlZCgwKX0lYCA6ICcnOwogICAgfSwKICAgIGZvbnRTaXplKCkgewogICAgICAvLyDlrZfkvZPlpKflsI/lj6/ku6XmoLnmja7mjInpkq7nmoTlpKflsI/liqjmgIHorqHnrpcKICAgICAgcmV0dXJuIHRoaXMucmFkaXVzIC8gMzsgLy8g56S65L6L5q+U5L6LCiAgICB9LAogIH0sCiAgbWV0aG9kczogewogICAgaGFuZGxlTW91c2VEb3duKCkgewogICAgICBpZiAodGhpcy5pc0J1dHRvbkRpc2FibGVkKSB7CiAgICAgICAgcmV0dXJuOyAKICAgICAgfQogICAgICB0aGlzLm1vdXNlUHJlc3NUaW1lc3RhbXAgPSBEYXRlLm5vdygpOwogICAgICBpZiAodGhpcy5pc0NsaWNrZWQpIHsKICAgICAgICB0aGlzLnN0YXJ0TG9uZ1ByZXNzQW5pbWF0aW9uKCk7CiAgICAgICAgdGhpcy5sb25nUHJlc3NUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgaWYgKERhdGUubm93KCkgLSB0aGlzLm1vdXNlUHJlc3NUaW1lc3RhbXAgPj0gdGhpcy5sb25nUHJlc3NUaHJlc2hvbGQpIHsKICAgICAgICAgICAgLy8g5aSE55CG6ZW/5oyJ6YC76L6RCiAgICAgICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuYW5pbWF0aW9uUmVxdWVzdCk7CiAgICAgICAgICAgIHRoaXMucmVzZXRQcm9ncmVzcygpOwogICAgICAgICAgfQogICAgICAgIH0sIHRoaXMubG9uZ1ByZXNzVGhyZXNob2xkKTsKICAgICAgfQogICAgfSwKCiAgICBoYW5kbGVNb3VzZVVwKCkgewogICAgICBjbGVhclRpbWVvdXQodGhpcy5sb25nUHJlc3NUaW1lcik7CgogICAgICBjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLmxvbmdQcmVzc0FuaW1hdGlvblJlcXVlc3QpOwogICAgICB0aGlzLmlzTG9uZ1ByZXNzID0gZmFsc2U7CiAgICAgIHRoaXMubG9uZ1ByZXNzUHJvZ3Jlc3MgPSAwOwoKICAgICAgY29uc3QgZWxhcHNlZCA9IERhdGUubm93KCkgLSB0aGlzLm1vdXNlUHJlc3NUaW1lc3RhbXA7CiAgICAgIGlmIChlbGFwc2VkIDwgdGhpcy5sb25nUHJlc3NUaHJlc2hvbGQpIHsKICAgICAgICAvLyDlpITnkIbngrnlh7vpgLvovpEKICAgICAgICBpZih0aGlzLk1haW5DYW1lcmFDb25uZWN0KSB7CiAgICAgICAgICB0aGlzLmFuaW1hdGVQcm9ncmVzcygpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRidXMuJGVtaXQoJ3Nob3dNc2dCb3gnLCAnUGxlYXNlIGNvbm5lY3QgdGhlIGNhbWVyYSBmaXJzdC4nLCAnZXJyb3InKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgYW5pbWF0ZVByb2dyZXNzKCkgewogICAgICBpZiAodGhpcy5pc0NsaWNrZWQpIHJldHVybjsgLy8g5aaC5p6c5bey54K55Ye777yM5YiZ6YCA5Ye65pa55rOVCiAgICAgIGNvbnNvbGUubG9nKCfmiafooYzngrnmjInvvIzop6blj5Hmi43mkYQnKTsKICAgICAgdGhpcy5hbmltYXRpb25EdXJhdGlvbiA9IHRoaXMuQ2FwdHVyZUV4cFRpbWU7CiAgICAgIHRoaXMuJGJ1cy4kZW1pdCgnQXBwU2VuZE1lc3NhZ2UnLCAnVnVlX0NvbW1hbmQnLCAndGFrZUV4cG9zdXJlOicrdGhpcy5hbmltYXRpb25EdXJhdGlvbik7CiAgICAgIHRoaXMuJGJ1cy4kZW1pdCgnU2VuZENvbnNvbGVMb2dNc2cnLCAnVGFrZSBFeHBvc3VyZTonK3RoaXMuYW5pbWF0aW9uRHVyYXRpb24sICdpbmZvJyk7CiAgICAgIHRoaXMuaXNDbGlja2VkID0gdHJ1ZTsKICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgIGNvbnN0IGFuaW1hdGUgPSAoY3VycmVudFRpbWUpID0+IHsKICAgICAgICBjb25zdCBlbGFwc2VkVGltZSA9IGN1cnJlbnRUaW1lIC0gc3RhcnRUaW1lOwogICAgICAgIHRoaXMucHJvZ3Jlc3MgPSBlbGFwc2VkVGltZSAvICh0aGlzLmFuaW1hdGlvbkR1cmF0aW9uIC8gMC45OSk7CgogICAgICAgIGlmICh0aGlzLnByb2dyZXNzIDwgMC45OSkgewogICAgICAgICAgdGhpcy5hbmltYXRpb25SZXF1ZXN0ID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnByb2dyZXNzID0gMC45OTsKICAgICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuYW5pbWF0aW9uUmVxdWVzdCk7CiAgICAgICAgfQogICAgICB9OwogICAgICBpZiAodGhpcy5hbmltYXRpb25SZXF1ZXN0KSB7CiAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5hbmltYXRpb25SZXF1ZXN0KTsKICAgICAgfQogICAgICB0aGlzLmFuaW1hdGlvblJlcXVlc3QgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYW5pbWF0ZSk7CiAgICB9LAoKICAgIG92ZXJQcm9ncmVzcygpIHsKICAgICAgdGhpcy5wcm9ncmVzcyA9IDE7CiAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuYW5pbWF0aW9uUmVxdWVzdCk7CiAgICAgIC8vIOW7tuaXtjLnp5LlkI7ph43nva7ov5vluqYKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgdGhpcy5yZXNldFByb2dyZXNzKCk7CiAgICAgIH0sIDIwMDApOwogICAgfSwKCiAgICByZXNldFByb2dyZXNzKCkgewogICAgICB0aGlzLnByb2dyZXNzID0gMDsKICAgICAgdGhpcy5pc0NsaWNrZWQgPSBmYWxzZTsKICAgIH0sCgogICAgU2V0RHVyYXRpb24odGltZSkgewogICAgICB0aGlzLkNhcHR1cmVFeHBUaW1lID0gdGltZTsKICAgIH0sCgogICAgc3RhcnRMb25nUHJlc3NBbmltYXRpb24oKSB7CiAgICAgIGNvbnNvbGUubG9nKCfmiafooYzplb/mjInvvIzop6blj5Hnu4jmraLmi43mkYQnKTsKICAgICAgdGhpcy5pc0xvbmdQcmVzcyA9IHRydWU7CiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICBjb25zdCBhbmltYXRlID0gKGN1cnJlbnRUaW1lKSA9PiB7CiAgICAgICAgY29uc3QgZWxhcHNlZFRpbWUgPSBjdXJyZW50VGltZSAtIHN0YXJ0VGltZTsKICAgICAgICB0aGlzLmxvbmdQcmVzc1Byb2dyZXNzID0gZWxhcHNlZFRpbWUgLyB0aGlzLmxvbmdQcmVzc1RocmVzaG9sZDsKCiAgICAgICAgaWYgKHRoaXMubG9uZ1ByZXNzUHJvZ3Jlc3MgPCAxKSB7CiAgICAgICAgICB0aGlzLmxvbmdQcmVzc0FuaW1hdGlvblJlcXVlc3QgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYW5pbWF0ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMubG9uZ1ByZXNzUHJvZ3Jlc3MgPSAxOwogICAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5sb25nUHJlc3NBbmltYXRpb25SZXF1ZXN0KTsKICAgICAgICAgIHRoaXMuJGJ1cy4kZW1pdCgnQXBwU2VuZE1lc3NhZ2UnLCAnVnVlX0NvbW1hbmQnLCAnYWJvcnRFeHBvc3VyZScpOwogICAgICAgICAgdGhpcy4kYnVzLiRlbWl0KCdTZW5kQ29uc29sZUxvZ01zZycsICdBYm9ydCBFeHBvc3VyZScsICdpbmZvJyk7CiAgICAgICAgICAvLyDlu7bml7Yy56eS5ZCO6YeN572u6L+b5bqmCiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgdGhpcy5yZXNldGxvbmdQcmVzc1Byb2dyZXNzKCk7CiAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICB0aGlzLmxvbmdQcmVzc0FuaW1hdGlvblJlcXVlc3QgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYW5pbWF0ZSk7CiAgICB9LAoKICAgIHJlc2V0bG9uZ1ByZXNzUHJvZ3Jlc3MoKSB7CiAgICAgIHRoaXMubG9uZ1ByZXNzUHJvZ3Jlc3MgPSAwOwogICAgICB0aGlzLmlzTG9uZ1ByZXNzID0gZmFsc2U7CiAgICB9LAoKICAgIHNldEluUHJvZ3Jlc3Moc3RhdGUpIHsKICAgICAgaWYoc3RhdGUgPT09ICdUcnVlJyl7CiAgICAgICAgdGhpcy5wcm9ncmVzcyA9IDAuOTk7CiAgICAgICAgdGhpcy5pc0NsaWNrZWQgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucHJvZ3Jlc3MgPSAwOwogICAgICAgIHRoaXMuaXNDbGlja2VkID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCgogICAgTWFpbkNhbWVyYUNvbm5lY3RlZChudW0pIHsKICAgICAgaWYobnVtID09PSAwKXsKICAgICAgICB0aGlzLk1haW5DYW1lcmFDb25uZWN0ID0gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5NYWluQ2FtZXJhQ29ubmVjdCA9IHRydWU7CiAgICAgIH0KICAgICAgY29uc29sZS5sb2coJ01haW5DYW1lcmEgaXMgQ29ubmVjdGVkOiAnLCBudW0pOwogICAgfSwKCiAgICBkaXNhYmxlQ2FwdHVyZUJ1dHRvbihzdGF0dXMpIHsKICAgICAgdGhpcy5pc0J1dHRvbkRpc2FibGVkID0gc3RhdHVzOwogICAgfSwKCiAgfSwKfTsK"},{"version":3,"sources":["CircularButton.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA","file":"CircularButton.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"circular-button no-select\">\n    <svg\n      @touchstart=\"handleMouseDown\" @touchend=\"handleMouseUp\"\n      @mousedown=\"handleMouseDown\" @mouseup=\"handleMouseUp\"\n      :width=\"svgSize\"\n      :height=\"svgSize\"\n      :viewBox=\"'0 0 ' + svgSize + ' ' + svgSize\"\n      style=\"cursor: pointer;\"\n    >\n      <!-- 背景圆圈 -->\n      <circle\n        :cx=\"svgSize / 2\"\n        :cy=\"svgSize / 2\"\n        :r=\"radius\"\n        fill=\"none\"\n        stroke=\"rgba(255, 255, 255, 0.5)\"\n        :stroke-width=\"strokeWidth\"\n      />\n      <!-- 红色进度条（长按时显示） -->\n       <circle\n        v-if=\"isLongPress\"\n        :cx=\"svgSize / 2\"\n        :cy=\"svgSize / 2\"\n        :r=\"radius\"\n        fill=\"none\"\n        stroke=\"rgba(255, 0, 0, 0.7)\"\n        :stroke-width=\"strokeWidth\"\n        :stroke-dasharray=\"circumference\"\n        :stroke-dashoffset=\"circumference * (1 - longPressProgress)\"\n        stroke-linecap=\"round\"\n        :transform=\"'rotate(-90 ' + svgSize / 2 + ' ' + svgSize / 2 + ')'\"\n      />\n      <!-- 进度条 -->\n      <circle\n        :cx=\"svgSize / 2\"\n        :cy=\"svgSize / 2\"\n        :r=\"radius\"\n        fill=\"none\"\n        stroke=\"rgba(0, 255, 0, 0.7)\"\n        :stroke-width=\"strokeWidth\"\n        :stroke-dasharray=\"circumference\"\n        :stroke-dashoffset=\"circumference * (1 - progress)\"\n        stroke-linecap=\"round\"\n        :transform=\"'rotate(-90 ' + svgSize / 2 + ' ' + svgSize / 2 + ')'\"\n      />\n      <!-- 按钮文本 -->\n      <text\n        :x=\"svgSize / 2\"\n        :y=\"svgSize / 2\"\n        fill=\"rgba(255, 255, 255, 0.7)\"\n        :font-size=\"fontSize\"\n        text-anchor=\"middle\"\n        alignment-baseline=\"central\"\n      >\n        {{ progressText }}\n      </text>\n\n      <image\n        :x=\"svgSize / 2\" \n        :y=\"svgSize / 2\"\n        v-if=\"!isClicked\"\n        xlink:href=\"@/assets/images/svg/ui/media record.svg\"\n        width=\"20px\" height=\"20px\"\n        style=\"transform: translate(-8px, -10px);\"\n      />\n\n    </svg>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      progress: 0,\n      // circumference: 339.292,\n      radius: 30, // 圆的半径\n      strokeWidth: 7, // 圆环的线宽\n      CaptureExpTime: 1,\n      animationDuration: 1, // 动画时长为1000毫秒（1秒）\n      animationStartTime: 0, // 动画开始时间\n      isClicked: false,\n\n      longPressThreshold: 1000,\n      longPressTimer: null,\n      PressTimestamp: 0,\n\n      isLongPress: false,\n      longPressProgress: 0,\n\n      MainCameraConnect: false,\n      isProcessing: false, // 新增状态变量，表示是否正在处理\n\n      isButtonDisabled: false, // 拍摄按钮是否禁用\n    };\n  },\n  created() {\n    this.$bus.$on('ExposureCompleted', this.overProgress);\n    this.$bus.$on('SetExpTime',this.SetDuration);\n    this.$bus.$on('CameraInExposuring',this.setInProgress);\n    this.$bus.$on('MainCameraConnected', this.MainCameraConnected);\n    this.$bus.$on('disableCaptureButton', this.disableCaptureButton);\n  },\n  mounted() {\n    this.$bus.$emit('AppSendMessage', 'Vue_Command', 'getCaptureStatus');\n  },\n  computed: {\n    svgSize() {\n      // SVG的大小应该足够包含圆形按钮及其边框\n      return this.radius * 2 + this.strokeWidth * 2;\n    },\n    circumference() {\n      // 计算圆周长\n      return 2 * Math.PI * this.radius;\n    },\n    progressText() {\n      return this.isClicked ? `${(this.progress * 100).toFixed(0)}%` : '';\n    },\n    fontSize() {\n      // 字体大小可以根据按钮的大小动态计算\n      return this.radius / 3; // 示例比例\n    },\n  },\n  methods: {\n    handleMouseDown() {\n      if (this.isButtonDisabled) {\n        return; \n      }\n      this.mousePressTimestamp = Date.now();\n      if (this.isClicked) {\n        this.startLongPressAnimation();\n        this.longPressTimer = setTimeout(() => {\n          if (Date.now() - this.mousePressTimestamp >= this.longPressThreshold) {\n            // 处理长按逻辑\n            cancelAnimationFrame(this.animationRequest);\n            this.resetProgress();\n          }\n        }, this.longPressThreshold);\n      }\n    },\n\n    handleMouseUp() {\n      clearTimeout(this.longPressTimer);\n\n      cancelAnimationFrame(this.longPressAnimationRequest);\n      this.isLongPress = false;\n      this.longPressProgress = 0;\n\n      const elapsed = Date.now() - this.mousePressTimestamp;\n      if (elapsed < this.longPressThreshold) {\n        // 处理点击逻辑\n        if(this.MainCameraConnect) {\n          this.animateProgress();\n        } else {\n          this.$bus.$emit('showMsgBox', 'Please connect the camera first.', 'error');\n        }\n      }\n    },\n\n    animateProgress() {\n      if (this.isClicked) return; // 如果已点击，则退出方法\n      console.log('执行点按，触发拍摄');\n      this.animationDuration = this.CaptureExpTime;\n      this.$bus.$emit('AppSendMessage', 'Vue_Command', 'takeExposure:'+this.animationDuration);\n      this.$bus.$emit('SendConsoleLogMsg', 'Take Exposure:'+this.animationDuration, 'info');\n      this.isClicked = true;\n      const startTime = performance.now();\n      const animate = (currentTime) => {\n        const elapsedTime = currentTime - startTime;\n        this.progress = elapsedTime / (this.animationDuration / 0.99);\n\n        if (this.progress < 0.99) {\n          this.animationRequest = requestAnimationFrame(animate);\n        } else {\n          this.progress = 0.99;\n          cancelAnimationFrame(this.animationRequest);\n        }\n      };\n      if (this.animationRequest) {\n        cancelAnimationFrame(this.animationRequest);\n      }\n      this.animationRequest = requestAnimationFrame(animate);\n    },\n\n    overProgress() {\n      this.progress = 1;\n      cancelAnimationFrame(this.animationRequest);\n      // 延时2秒后重置进度\n      setTimeout(() => {\n        this.resetProgress();\n      }, 2000);\n    },\n\n    resetProgress() {\n      this.progress = 0;\n      this.isClicked = false;\n    },\n\n    SetDuration(time) {\n      this.CaptureExpTime = time;\n    },\n\n    startLongPressAnimation() {\n      console.log('执行长按，触发终止拍摄');\n      this.isLongPress = true;\n      const startTime = performance.now();\n      const animate = (currentTime) => {\n        const elapsedTime = currentTime - startTime;\n        this.longPressProgress = elapsedTime / this.longPressThreshold;\n\n        if (this.longPressProgress < 1) {\n          this.longPressAnimationRequest = requestAnimationFrame(animate);\n        } else {\n          this.longPressProgress = 1;\n          cancelAnimationFrame(this.longPressAnimationRequest);\n          this.$bus.$emit('AppSendMessage', 'Vue_Command', 'abortExposure');\n          this.$bus.$emit('SendConsoleLogMsg', 'Abort Exposure', 'info');\n          // 延时2秒后重置进度\n          setTimeout(() => {\n            this.resetlongPressProgress();\n          }, 1000);\n        }\n      };\n\n      this.longPressAnimationRequest = requestAnimationFrame(animate);\n    },\n\n    resetlongPressProgress() {\n      this.longPressProgress = 0;\n      this.isLongPress = false;\n    },\n\n    setInProgress(state) {\n      if(state === 'True'){\n        this.progress = 0.99;\n        this.isClicked = true;\n      } else {\n        this.progress = 0;\n        this.isClicked = false;\n      }\n    },\n\n    MainCameraConnected(num) {\n      if(num === 0){\n        this.MainCameraConnect = false;\n      } else {\n        this.MainCameraConnect = true;\n      }\n      console.log('MainCamera is Connected: ', num);\n    },\n\n    disableCaptureButton(status) {\n      this.isButtonDisabled = status;\n    },\n\n  },\n};\n</script>\n\n<style scoped>\n.circular-button {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n</style>\n\n\n"]}]}
